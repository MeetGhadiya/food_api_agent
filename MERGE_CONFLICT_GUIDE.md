# 🔧 GitHub Merge Conflict Resolution Guide

**Problem:** Merge conflicts in `node_modules` and `__pycache__` directories
**Solution:** Remove these files from Git and update .gitignore
**Status:** ✅ Ready to resolve

---

## 🎯 Quick Fix (Run This)

### Option 1: Automated Script (Recommended)
```powershell
.\RESOLVE_CONFLICTS.ps1
```

### Option 2: Manual Commands
```bash
# 1. Remove cached dependency directories
git rm -r --cached chatbot_frontend/node_modules
git rm -r --cached food_api/app/__pycache__
git rm -r --cached food_chatbot_agent/__pycache__

# 2. Stage the updated .gitignore
git add .gitignore

# 3. Commit the fix
git commit -m "Fix: Remove node_modules and __pycache__ from Git tracking"

# 4. Push to your branch
git push origin MG
```

---

## 📋 Understanding the Problem

### Why These Conflicts Happen

**node_modules/** (JavaScript/Node.js dependencies)
- Contains 1000+ files from npm packages
- Different across platforms and Node versions
- Changes constantly with updates
- Should NEVER be in Git

**__pycache__/** (Python bytecode cache)
- Auto-generated by Python interpreter
- Contains compiled .pyc files
- Changes with every code execution
- Should NEVER be in Git

**Why conflicts occur:**
1. Someone committed these directories to `main` branch
2. You have different versions on your `MG` branch
3. Git can't automatically merge because files differ
4. Result: Merge conflict in hundreds of files

---

## ✅ Solution Steps (Detailed)

### Step 1: Update .gitignore
✅ **DONE** - .gitignore now includes:
```
# Python cache
__pycache__/
*.py[cod]

# Node.js dependencies
node_modules/
npm-debug.log*
package-lock.json
```

### Step 2: Remove from Git (Keep Local Copy)
```bash
# This removes files from Git but keeps them on your computer
git rm -r --cached chatbot_frontend/node_modules
git rm -r --cached food_api/app/__pycache__
git rm -r --cached food_chatbot_agent/__pycache__
```

**What `--cached` does:**
- Removes files from Git index (staging area)
- KEEPS files on your local disk
- They won't be deleted, just untracked

### Step 3: Commit the Change
```bash
git add .gitignore
git commit -m "Fix: Remove node_modules and __pycache__ from Git tracking

- Added node_modules to .gitignore
- Removed cached dependency directories
- Resolves merge conflicts in auto-generated files"
```

### Step 4: Push to GitHub
```bash
git push origin MG
```

### Step 5: Merge on GitHub
1. Go to your Pull Request
2. Click "Resolve conflicts" button (should disappear)
3. If still there, click and accept "main" version
4. Click "Mark as resolved"
5. Click "Merge pull request"

---

## 🔄 If You Need to Pull Latest Changes

```bash
# Pull latest from main with rebase
git pull origin main --rebase

# If conflicts, resolve them:
git add <resolved-file>
git rebase --continue

# Push your changes
git push origin MG --force-with-lease
```

---

## 🆘 Troubleshooting

### Problem: "fatal: pathspec did not match any files"
**Solution:** The directory doesn't exist in Git, skip it
```bash
# Ignore the error and continue
```

### Problem: "error: the following files would be overwritten"
**Solution:** Commit or stash your changes first
```bash
git stash
# Run conflict resolution
git stash pop
```

### Problem: Still showing conflicts on GitHub
**Solution:** Accept their version for dependency files
```bash
# In GitHub conflict editor, click "Accept theirs" for:
# - All node_modules files
# - All __pycache__ files
# - All package-lock.json files
```

### Problem: "Permission denied" or "Access denied"
**Solution:** Close any running processes
```bash
# Stop all services
docker-compose down
# Kill Node/Python processes
# Then retry
```

---

## 🎯 Prevention (For Future)

### Always in .gitignore:
```
# Dependencies
node_modules/
venv/
env/

# Cache
__pycache__/
.pytest_cache/
.mypy_cache/

# Build output
dist/
build/
*.egg-info/

# Secrets
.env
*.env
!.env.example

# OS
.DS_Store
Thumbs.db

# IDE
.vscode/
.idea/
```

### Before Committing:
```bash
# Check what you're committing
git status

# If you see node_modules or __pycache__:
# DO NOT COMMIT!
# Add them to .gitignore first
```

### Team Communication:
1. ✅ Everyone should run: `npm install` (not commit node_modules)
2. ✅ Everyone should run: `pip install -r requirements.txt` (not commit venv)
3. ✅ Everyone should have same .gitignore
4. ❌ Nobody should commit auto-generated files

---

## 📊 What's Safe to Commit vs Not

### ✅ SAFE to Commit:
- Source code (.py, .js, .jsx)
- Configuration files (.json, .yml, .env.example)
- Documentation (.md, .txt)
- Requirements files (requirements.txt, package.json)
- Dockerfiles
- Static assets (images, CSS)

### ❌ NEVER Commit:
- Dependencies (node_modules, venv)
- Cache files (__pycache__, .pytest_cache)
- Build output (dist, build)
- Secrets (.env with actual keys)
- OS files (.DS_Store, Thumbs.db)
- IDE settings (.vscode, .idea)
- Database files (*.db, *.sqlite)
- Log files (*.log)

---

## 🔍 Verify the Fix

After running the resolution:

### 1. Check Git Status
```bash
git status
# Should show only tracked files
# No node_modules or __pycache__
```

### 2. Check .gitignore Working
```bash
# Create a test file
echo "test" > node_modules/test.txt

# Check if Git ignores it
git status
# Should NOT show node_modules/test.txt
```

### 3. Check GitHub PR
- Go to Pull Request page
- Conflicts section should be empty
- Should show "This branch has no conflicts with the base branch"
- Green "Merge pull request" button should be available

---

## 📞 Need More Help?

### If automated script fails:
1. Read error message carefully
2. Copy error to ChatGPT or Copilot
3. Check git status: `git status`
4. Check what's staged: `git diff --cached`

### Common commands to check:
```bash
# See current branch
git branch

# See what's tracked
git ls-files

# See what's ignored
git status --ignored

# See commit history
git log --oneline -10
```

### Emergency reset (CAUTION):
```bash
# If everything breaks, reset to last commit
git reset --hard HEAD

# Or reset to main branch
git fetch origin
git reset --hard origin/main
```

---

## ✅ Success Criteria

You'll know it worked when:

1. ✅ `git status` shows clean working directory
2. ✅ No `node_modules` or `__pycache__` in `git ls-files`
3. ✅ GitHub PR shows "No conflicts"
4. ✅ Green "Merge pull request" button available
5. ✅ All checks passing

---

## 🎉 After Successful Merge

### Update your local main branch:
```bash
# Switch to main
git checkout main

# Pull merged changes
git pull origin main

# Delete your feature branch (optional)
git branch -d MG
```

### Clean up (optional):
```bash
# Remove old node_modules
rm -rf chatbot_frontend/node_modules

# Reinstall (if needed)
cd chatbot_frontend
npm install
```

---

**Remember:** Dependencies are installed via `npm install` or `pip install`, never committed! 🚀
