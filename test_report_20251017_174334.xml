<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="81" failures="40" skipped="0" tests="169" time="31.476" timestamp="2025-10-17T17:43:36.889913+05:30" hostname="SkillTechPC"><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminRestaurantManagement" name="test_admin_001_create_restaurant" time="1.034" /><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminRestaurantManagement" name="test_admin_002_user_cannot_create_restaurant" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminRestaurantManagement" name="test_admin_003_update_restaurant" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:81: in test_admin
    existing_admin = await User.find_one(User.username == "testadmin")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminRestaurantManagement" name="test_admin_004_user_cannot_update_restaurant" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminRestaurantManagement" name="test_admin_005_delete_restaurant" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:81: in test_admin
    existing_admin = await User.find_one(User.username == "testadmin")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminRestaurantManagement" name="test_admin_006_user_cannot_delete_restaurant" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminDashboard" name="test_admin_007_access_platform_statistics" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:81: in test_admin
    existing_admin = await User.find_one(User.username == "testadmin")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminDashboard" name="test_admin_008_user_cannot_access_statistics" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminDashboard" name="test_admin_009_view_all_orders" time="0.005"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:81: in test_admin
    existing_admin = await User.find_one(User.username == "testadmin")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminDashboard" name="test_admin_010_view_all_users_no_passwords" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:81: in test_admin
    existing_admin = await User.find_one(User.username == "testadmin")
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminRBACEdgeCases" name="test_admin_endpoints_require_authentication" time="0.010" /><testcase classname="tests.test_admin_functionality_comprehensive.TestAdminRBACEdgeCases" name="test_regular_user_cannot_access_any_admin_endpoint" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_ai_agent_conversation.TestAIAgentConversation" name="test_ai_001_greeting_and_help" time="0.003" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentConversation" name="test_ai_002_item_search_tool_calling" time="0.003" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentConversation" name="test_ai_003_context_retention" time="0.004" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentConversation" name="test_ai_004_graceful_failure_nonexistent_item" time="0.003" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentConversation" name="test_ai_005_keyword_routing_cuisine_search" time="0.004" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentConversation" name="test_ai_006_order_placement_not_supported" time="0.003" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentAdvancedScenarios" name="test_ai_multi_turn_order_conversation" time="0.003" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentAdvancedScenarios" name="test_ai_review_submission_via_chat" time="0.003" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentAdvancedScenarios" name="test_ai_personalization_greeting" time="0.003" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentAdvancedScenarios" name="test_ai_context_switching" time="0.004" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentAdvancedScenarios" name="test_ai_error_recovery" time="0.003" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentToolFunctions" name="test_search_by_item_tool_format" time="0.002" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentToolFunctions" name="test_search_by_cuisine_tool_format" time="0.002" /><testcase classname="tests.test_ai_agent_conversation.TestAIAgentToolFunctions" name="test_get_restaurant_menu_tool_format" time="0.002" /><testcase classname="tests.test_api_auth.TestUserRegistration" name="test_register_new_user_success" time="0.010"><failure message="assert 500 == 201&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   201 = status.HTTP_201_CREATED">food_api\tests\test_api_auth.py:33: in test_register_new_user_success
    assert response.status_code == status.HTTP_201_CREATED
E   assert 500 == 201
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   201 = status.HTTP_201_CREATED</failure></testcase><testcase classname="tests.test_api_auth.TestUserRegistration" name="test_register_duplicate_username" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_auth.TestUserRegistration" name="test_register_duplicate_email" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_auth.TestUserRegistration" name="test_register_weak_password" time="0.007" /><testcase classname="tests.test_api_auth.TestUserRegistration" name="test_register_invalid_email" time="0.008" /><testcase classname="tests.test_api_auth.TestUserLogin" name="test_login_success" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_auth.TestUserLogin" name="test_login_wrong_password" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_auth.TestUserLogin" name="test_login_nonexistent_user" time="0.009"><failure message="assert 500 == 401&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   401 = status.HTTP_401_UNAUTHORIZED">food_api\tests\test_api_auth.py:143: in test_login_nonexistent_user
    assert response.status_code == status.HTTP_401_UNAUTHORIZED
E   assert 500 == 401
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   401 = status.HTTP_401_UNAUTHORIZED</failure></testcase><testcase classname="tests.test_api_auth.TestUserLogin" name="test_login_rate_limiting" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_auth.TestProtectedEndpoints" name="test_protected_endpoint_no_token" time="0.006"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_auth.py", line 185, in test_protected_endpoint_no_token
    |     response = await async_client.post("/orders/", json=order_data)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;13 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 1001, in create_order
    |     restaurant = await Restaurant.find_one(Restaurant.name == order_data.restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_auth.py", line 185, in test_protected_endpoint_no_token
    response = await async_client.post("/orders/", json=order_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;13 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 1001, in create_order
    restaurant = await Restaurant.find_one(Restaurant.name == order_data.restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_api_auth.py:185: in test_protected_endpoint_no_token
    response = await async_client.post("/orders/", json=order_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1859: in post
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:1001: in create_order
    restaurant = await Restaurant.find_one(Restaurant.name == order_data.restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_api_auth.TestProtectedEndpoints" name="test_protected_endpoint_invalid_token" time="0.006"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_auth.py", line 202, in test_protected_endpoint_invalid_token
    |     response = await async_client.post("/orders/", json=order_data, headers=headers)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;13 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 1001, in create_order
    |     restaurant = await Restaurant.find_one(Restaurant.name == order_data.restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_auth.py", line 202, in test_protected_endpoint_invalid_token
    response = await async_client.post("/orders/", json=order_data, headers=headers)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;13 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 1001, in create_order
    restaurant = await Restaurant.find_one(Restaurant.name == order_data.restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_api_auth.py:202: in test_protected_endpoint_invalid_token
    response = await async_client.post("/orders/", json=order_data, headers=headers)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1859: in post
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:1001: in create_order
    restaurant = await Restaurant.find_one(Restaurant.name == order_data.restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_api_auth.TestProtectedEndpoints" name="test_protected_endpoint_with_valid_token" time="0.011"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_auth.TestProtectedEndpoints" name="test_get_current_user_info" time="0.008"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_auth.TestAuthenticationSecurity" name="test_sql_injection_in_login" time="0.010"><failure message="assert 500 == 401&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   401 = status.HTTP_401_UNAUTHORIZED">food_api\tests\test_api_auth.py:259: in test_sql_injection_in_login
    assert response.status_code == status.HTTP_401_UNAUTHORIZED
E   assert 500 == 401
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   401 = status.HTTP_401_UNAUTHORIZED</failure></testcase><testcase classname="tests.test_api_auth.TestAuthenticationSecurity" name="test_password_not_returned_in_responses" time="0.014" /><testcase classname="tests.test_api_public.TestRestaurantEndpoints" name="test_pub_001_get_root" time="0.005" /><testcase classname="tests.test_api_public.TestRestaurantEndpoints" name="test_get_all_restaurants" time="0.005"><failure message="assert 500 == 200&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   200 = status.HTTP_200_OK">food_api\tests\test_api_public.py:50: in test_get_all_restaurants
    assert response.status_code == status.HTTP_200_OK
E   assert 500 == 200
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   200 = status.HTTP_200_OK</failure></testcase><testcase classname="tests.test_api_public.TestRestaurantEndpoints" name="test_get_restaurants_by_cuisine" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_public.TestRestaurantEndpoints" name="test_get_restaurants_case_insensitive_cuisine" time="0.008" /><testcase classname="tests.test_api_public.TestRestaurantEndpoints" name="test_get_restaurant_by_name" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_public.TestRestaurantEndpoints" name="test_get_nonexistent_restaurant" time="0.004"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_public.py", line 106, in test_get_nonexistent_restaurant
    |     response = await async_client.get("/restaurants/NonExistentRestaurant12345")
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;9 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    |     restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_public.py", line 106, in test_get_nonexistent_restaurant
    response = await async_client.get("/restaurants/NonExistentRestaurant12345")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;9 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_api_public.py:106: in test_get_nonexistent_restaurant
    response = await async_client.get("/restaurants/NonExistentRestaurant12345")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1768: in get
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:307: in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_api_public.TestSearchEndpoints" name="test_search_restaurants_by_item" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_public.TestSearchEndpoints" name="test_search_nonexistent_item" time="0.004"><failure message="assert 500 in [200, 404]&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code">food_api\tests\test_api_public.py:139: in test_search_nonexistent_item
    assert response.status_code in [status.HTTP_200_OK, status.HTTP_404_NOT_FOUND]
E   assert 500 in [200, 404]
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code</failure></testcase><testcase classname="tests.test_api_public.TestHealthCheck" name="test_health_check" time="0.004" /><testcase classname="tests.test_api_public.TestPublicReviewEndpoints" name="test_get_restaurant_reviews" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_public.TestPublicReviewEndpoints" name="test_get_review_stats" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_public.TestInputValidation" name="test_sql_injection_in_restaurant_search" time="0.004"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_public.py", line 206, in test_sql_injection_in_restaurant_search
    |     response = await async_client.get(f"/restaurants/{malicious_input}")
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;9 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    |     restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_public.py", line 206, in test_sql_injection_in_restaurant_search
    response = await async_client.get(f"/restaurants/{malicious_input}")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;9 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_api_public.py:206: in test_sql_injection_in_restaurant_search
    response = await async_client.get(f"/restaurants/{malicious_input}")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1768: in get
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:307: in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_api_public.TestInputValidation" name="test_xss_in_search_query" time="0.004"><failure message="assert 500 in [200, 404]&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code">food_api\tests\test_api_public.py:224: in test_xss_in_search_query
    assert response.status_code in [status.HTTP_200_OK, status.HTTP_404_NOT_FOUND]
E   assert 500 in [200, 404]
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code</failure></testcase><testcase classname="tests.test_api_public.TestInputValidation" name="test_nosql_injection_in_cuisine_filter" time="0.005"><failure message="assert 500 == 200&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   200 = status.HTTP_200_OK">food_api\tests\test_api_public.py:243: in test_nosql_injection_in_cuisine_filter
    assert response.status_code == status.HTTP_200_OK
E   assert 500 == 200
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   200 = status.HTTP_200_OK</failure></testcase><testcase classname="tests.test_api_public.TestSmokeTests" name="test_api_is_running" time="0.004" /><testcase classname="tests.test_api_public.TestSmokeTests" name="test_critical_endpoints_accessible" time="0.007"><failure message="assert 500 in [200, 404]&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code">food_api\tests\test_api_public.py:267: in test_critical_endpoints_accessible
    assert response.status_code in [
E   assert 500 in [200, 404]
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code</failure></testcase><testcase classname="tests.test_api_reviews" name="test_create_review_success" time="0.006"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_create_review_requires_auth" time="0.005"><failure message="TypeError: 'NoneType' object is not subscriptable">food_api\tests\test_api_reviews.py:40: in test_create_review_requires_auth
    "restaurant_name": sample_restaurant["name"],
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: 'NoneType' object is not subscriptable</failure></testcase><testcase classname="tests.test_api_reviews" name="test_create_review_invalid_rating" time="0.006"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_create_review_comment_too_short" time="0.006"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_create_duplicate_review" time="0.006"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_get_restaurant_reviews" time="0.026"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_get_reviews_with_pagination" time="0.005"><failure message="TypeError: 'NoneType' object is not subscriptable">food_api\tests\test_api_reviews.py:154: in test_get_reviews_with_pagination
    f"/restaurants/{sample_restaurant['name']}/reviews",
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: 'NoneType' object is not subscriptable</failure></testcase><testcase classname="tests.test_api_reviews" name="test_get_reviews_nonexistent_restaurant" time="0.006"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_reviews.py", line 165, in test_get_reviews_nonexistent_restaurant
    |     response = client.get("/restaurants/NonExistentRestaurant/reviews")
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\testclient.py", line 479, in get
    |     return super().get(
    |            ~~~~~~~~~~~^
    |         url,
    |         ^^^^
    |     ...&lt;6 lines&gt;...
    |         extensions=extensions,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1053, in get
    |     return self.request(
    |            ~~~~~~~~~~~~^
    |         "GET",
    |         ^^^^^^
    |     ...&lt;7 lines&gt;...
    |         extensions=extensions,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\testclient.py", line 451, in request
    |     return super().request(
    |            ~~~~~~~~~~~~~~~^
    |         method,
    |         ^^^^^^^
    |     ...&lt;11 lines&gt;...
    |         extensions=extensions,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 825, in request
    |     return self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 914, in send
    |     response = self._send_handling_auth(
    |         request,
    |     ...&lt;2 lines&gt;...
    |         history=[],
    |     )
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    |     response = self._send_handling_redirects(
    |         request,
    |         follow_redirects=follow_redirects,
    |         history=history,
    |     )
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    |     response = self._send_single_request(request)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    |     response = transport.handle_request(request)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\testclient.py", line 354, in handle_request
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\testclient.py", line 351, in handle_request
    |     portal.call(self.app, scope, receive, send)
    |     ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\from_thread.py", line 291, in call
    |     return cast(T_Retval, self.start_task_soon(func, *args).result())
    |                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\concurrent\futures\_base.py", line 456, in result
    |     return self.__get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\concurrent\futures\_base.py", line 401, in __get_result
    |     raise self._exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\from_thread.py", line 222, in _call_func
    |     retval = await retval_or_awaitable
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 433, in get_restaurant_reviews
    |     restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_api_reviews.py", line 165, in test_get_reviews_nonexistent_restaurant
    response = client.get("/restaurants/NonExistentRestaurant/reviews")
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\testclient.py", line 479, in get
    return super().get(
           ~~~~~~~~~~~^
        url,
        ^^^^
    ...&lt;6 lines&gt;...
        extensions=extensions,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1053, in get
    return self.request(
           ~~~~~~~~~~~~^
        "GET",
        ^^^^^^
    ...&lt;7 lines&gt;...
        extensions=extensions,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\testclient.py", line 451, in request
    return super().request(
           ~~~~~~~~~~~~~~~^
        method,
        ^^^^^^^
    ...&lt;11 lines&gt;...
        extensions=extensions,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 825, in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 914, in send
    response = self._send_handling_auth(
        request,
    ...&lt;2 lines&gt;...
        history=[],
    )
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 942, in _send_handling_auth
    response = self._send_handling_redirects(
        request,
        follow_redirects=follow_redirects,
        history=history,
    )
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 979, in _send_handling_redirects
    response = self._send_single_request(request)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1014, in _send_single_request
    response = transport.handle_request(request)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\testclient.py", line 354, in handle_request
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\testclient.py", line 351, in handle_request
    portal.call(self.app, scope, receive, send)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\from_thread.py", line 291, in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\concurrent\futures\_base.py", line 456, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\from_thread.py", line 222, in _call_func
    retval = await retval_or_awaitable
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 433, in get_restaurant_reviews
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_api_reviews.py:165: in test_get_reviews_nonexistent_restaurant
    response = client.get("/restaurants/NonExistentRestaurant/reviews")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\testclient.py:479: in get
    return super().get(
..\..\..\Lib\site-packages\httpx\_client.py:1053: in get
    return self.request(
..\..\..\Lib\site-packages\starlette\testclient.py:451: in request
    return super().request(
..\..\..\Lib\site-packages\httpx\_client.py:825: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:914: in send
    response = self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:942: in _send_handling_auth
    response = self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:979: in _send_handling_redirects
    response = self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1014: in _send_single_request
    response = transport.handle_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\testclient.py:354: in handle_request
    raise exc
..\..\..\Lib\site-packages\starlette\testclient.py:351: in handle_request
    portal.call(self.app, scope, receive, send)
..\..\..\Lib\site-packages\anyio\from_thread.py:291: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\concurrent\futures\_base.py:456: in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\concurrent\futures\_base.py:401: in __get_result
    raise self._exception
..\..\..\Lib\site-packages\anyio\from_thread.py:222: in _call_func
    retval = await retval_or_awaitable
             ^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:433: in get_restaurant_reviews
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_api_reviews" name="test_update_review" time="0.023"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_update_review_unauthorized" time="0.006"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_delete_review" time="0.026"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_get_my_reviews" time="0.008"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_get_my_reviews_requires_auth" time="0.008" /><testcase classname="tests.test_api_reviews" name="test_review_xss_protection" time="0.007"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_api_reviews" name="test_review_stats" time="0.007"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_authentication_comprehensive.TestUserRegistration" name="test_auth_001_register_new_user_success" time="0.003"><failure message="RuntimeError: Event loop is closed">food_api\tests\test_authentication_comprehensive.py:56: in test_auth_001_register_new_user_success
    existing = await User.find_one(User.email == user_data["email"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_authentication_comprehensive.TestUserRegistration" name="test_auth_002_register_duplicate_email" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_authentication_comprehensive.TestUserRegistration" name="test_auth_003_register_duplicate_username" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_authentication_comprehensive.TestUserRegistration" name="test_auth_004_register_password_too_short" time="0.005" /><testcase classname="tests.test_authentication_comprehensive.TestUserRegistration" name="test_auth_005_register_password_no_numbers" time="0.006"><failure message="assert 500 == 422&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   422 = status.HTTP_422_UNPROCESSABLE_ENTITY">food_api\tests\test_authentication_comprehensive.py:181: in test_auth_005_register_password_no_numbers
    assert response.status_code == status.HTTP_422_UNPROCESSABLE_ENTITY
E   assert 500 == 422
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   422 = status.HTTP_422_UNPROCESSABLE_ENTITY</failure></testcase><testcase classname="tests.test_authentication_comprehensive.TestUserRegistration" name="test_auth_006_register_password_no_letters" time="0.006"><failure message="assert 500 == 422&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   422 = status.HTTP_422_UNPROCESSABLE_ENTITY">food_api\tests\test_authentication_comprehensive.py:211: in test_auth_006_register_password_no_letters
    assert response.status_code == status.HTTP_422_UNPROCESSABLE_ENTITY
E   assert 500 == 422
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   422 = status.HTTP_422_UNPROCESSABLE_ENTITY</failure></testcase><testcase classname="tests.test_authentication_comprehensive.TestUserRegistration" name="test_auth_007_register_invalid_username" time="0.004"><failure message="TypeError: Object of type ValueError is not JSON serializable">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_authentication_comprehensive.py", line 239, in test_auth_007_register_invalid_username
    |     response = await async_client.post("/users/register", json=invalid_username_user)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;13 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 59, in wrapped_app
    |     response = await handler(conn, exc)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 201, in validation_exception_handler
    |     return JSONResponse(
    |         status_code=422,
    |     ...&lt;3 lines&gt;...
    |         }
    |     )
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\responses.py", line 190, in __init__
    |     super().__init__(content, status_code, headers, media_type, background)
    |     ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\responses.py", line 47, in __init__
    |     self.body = self.render(content)
    |                 ~~~~~~~~~~~^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\responses.py", line 193, in render
    |     return json.dumps(
    |            ~~~~~~~~~~^
    |         content,
    |         ^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |         separators=(",", ":"),
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     ).encode("utf-8")
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\json\__init__.py", line 238, in dumps
    |     **kw).encode(obj)
    |           ~~~~~~^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\json\encoder.py", line 200, in encode
    |     chunks = self.iterencode(o, _one_shot=True)
    |   File "C:\Users\Skill\Desktop\m\Lib\json\encoder.py", line 261, in iterencode
    |     return _iterencode(o, 0)
    |   File "C:\Users\Skill\Desktop\m\Lib\json\encoder.py", line 180, in default
    |     raise TypeError(f'Object of type {o.__class__.__name__} '
    |                     f'is not JSON serializable')
    | TypeError: Object of type ValueError is not JSON serializable
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_authentication_comprehensive.py", line 239, in test_auth_007_register_invalid_username
    response = await async_client.post("/users/register", json=invalid_username_user)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;13 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 59, in wrapped_app
    response = await handler(conn, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 201, in validation_exception_handler
    return JSONResponse(
        status_code=422,
    ...&lt;3 lines&gt;...
        }
    )
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\responses.py", line 190, in __init__
    super().__init__(content, status_code, headers, media_type, background)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\responses.py", line 47, in __init__
    self.body = self.render(content)
                ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\responses.py", line 193, in render
    return json.dumps(
           ~~~~~~~~~~^
        content,
        ^^^^^^^^
    ...&lt;3 lines&gt;...
        separators=(",", ":"),
        ^^^^^^^^^^^^^^^^^^^^^^
    ).encode("utf-8")
    ^
  File "C:\Users\Skill\Desktop\m\Lib\json\__init__.py", line 238, in dumps
    **kw).encode(obj)
          ~~~~~~^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\json\encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "C:\Users\Skill\Desktop\m\Lib\json\encoder.py", line 261, in iterencode
    return _iterencode(o, 0)
  File "C:\Users\Skill\Desktop\m\Lib\json\encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
                    f'is not JSON serializable')
TypeError: Object of type ValueError is not JSON serializable

During handling of the above exception, another exception occurred:
food_api\tests\test_authentication_comprehensive.py:239: in test_auth_007_register_invalid_username
    response = await async_client.post("/users/register", json=invalid_username_user)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1859: in post
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:59: in wrapped_app
    response = await handler(conn, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:201: in validation_exception_handler
    return JSONResponse(
..\..\..\Lib\site-packages\starlette\responses.py:190: in __init__
    super().__init__(content, status_code, headers, media_type, background)
..\..\..\Lib\site-packages\starlette\responses.py:47: in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\responses.py:193: in render
    return json.dumps(
..\..\..\Lib\json\__init__.py:238: in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
..\..\..\Lib\json\encoder.py:200: in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\json\encoder.py:261: in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
..\..\..\Lib\json\encoder.py:180: in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
E   TypeError: Object of type ValueError is not JSON serializable</failure></testcase><testcase classname="tests.test_authentication_comprehensive.TestUserRegistration" name="test_auth_008_register_invalid_email" time="0.004" /><testcase classname="tests.test_authentication_comprehensive.TestUserLogin" name="test_auth_009_login_success" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_authentication_comprehensive.TestUserLogin" name="test_auth_010_login_incorrect_password" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_authentication_comprehensive.TestUserLogin" name="test_auth_011_login_rate_limiting" time="0.326"><failure message="pydantic_core._pydantic_core.ValidationError: 2 validation errors for User&#10;first_name&#10;  Field required [type=missing, input_value={'username': 'ratelimitus...SPFp0K', 'role': 'user'}, input_type=dict]&#10;    For further information visit https://errors.pydantic.dev/2.11/v/missing&#10;last_name&#10;  Field required [type=missing, input_value={'username': 'ratelimitus...SPFp0K', 'role': 'user'}, input_type=dict]&#10;    For further information visit https://errors.pydantic.dev/2.11/v/missing">food_api\tests\test_authentication_comprehensive.py:349: in test_auth_011_login_rate_limiting
    test_user_rl = User(
..\..\..\Lib\site-packages\beanie\odm\documents.py:208: in __init__
    super(Document, self).__init__(*args, **kwargs)
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for User
E   first_name
E     Field required [type=missing, input_value={'username': 'ratelimitus...SPFp0K', 'role': 'user'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing
E   last_name
E     Field required [type=missing, input_value={'username': 'ratelimitus...SPFp0K', 'role': 'user'}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.11/v/missing</failure></testcase><testcase classname="tests.test_authentication_comprehensive.TestProtectedEndpoints" name="test_auth_012_get_current_user_valid_token" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_authentication_comprehensive.TestProtectedEndpoints" name="test_auth_013_get_current_user_no_token" time="0.005"><failure message="AssertionError: assert 'not authenticated' in 'authorization header missing'&#10; +  where 'authorization header missing' = &lt;built-in method lower of str object at 0x00000277E38917A0&gt;()&#10; +    where &lt;built-in method lower of str object at 0x00000277E38917A0&gt; = 'Authorization header missing'.lower">food_api\tests\test_authentication_comprehensive.py:445: in test_auth_013_get_current_user_no_token
    assert "not authenticated" in data["detail"].lower()
E   AssertionError: assert 'not authenticated' in 'authorization header missing'
E    +  where 'authorization header missing' = &lt;built-in method lower of str object at 0x00000277E38917A0&gt;()
E    +    where &lt;built-in method lower of str object at 0x00000277E38917A0&gt; = 'Authorization header missing'.lower</failure></testcase><testcase classname="tests.test_authentication_comprehensive.TestProtectedEndpoints" name="test_auth_014_get_current_user_invalid_token" time="0.005" /><testcase classname="tests.test_authentication_comprehensive.TestAuthenticationSecurity" name="test_sql_injection_in_login" time="0.009"><failure message="AssertionError: SQL injection attempt with 'admin' OR '1'='1' should be rejected&#10;assert 500 == 401&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   401 = status.HTTP_401_UNAUTHORIZED">food_api\tests\test_authentication_comprehensive.py:501: in test_sql_injection_in_login
    assert response.status_code == status.HTTP_401_UNAUTHORIZED, \
E   AssertionError: SQL injection attempt with 'admin' OR '1'='1' should be rejected
E   assert 500 == 401
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   401 = status.HTTP_401_UNAUTHORIZED</failure></testcase><testcase classname="tests.test_authentication_comprehensive.TestAuthenticationSecurity" name="test_password_not_returned_in_responses" time="0.003"><failure message="RuntimeError: Event loop is closed">food_api\tests\test_authentication_comprehensive.py:516: in test_password_not_returned_in_responses
    existing = await User.find_one(User.email == user_data["email"])
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_main_api.TestPublicEndpoints" name="test_read_root" time="0.007"><failure message="AssertionError: assert '4.0.0' == '2.0.0'&#10;  &#10;  #x1B[0m#x1B[91m- 2.0.0#x1B[39;49;00m#x1B[90m#x1B[39;49;00m&#10;  ? ^#x1B[90m#x1B[39;49;00m&#10;  #x1B[92m+ 4.0.0#x1B[39;49;00m#x1B[90m#x1B[39;49;00m&#10;  ? ^#x1B[90m#x1B[39;49;00m">food_api\tests\test_main_api.py:22: in test_read_root
    assert data["version"] == "2.0.0"
E   AssertionError: assert '4.0.0' == '2.0.0'
E     
E     #x1B[0m#x1B[91m- 2.0.0#x1B[39;49;00m#x1B[90m#x1B[39;49;00m
E     ? ^#x1B[90m#x1B[39;49;00m
E     #x1B[92m+ 4.0.0#x1B[39;49;00m#x1B[90m#x1B[39;49;00m
E     ? ^#x1B[90m#x1B[39;49;00m</failure></testcase><testcase classname="tests.test_main_api.TestPublicEndpoints" name="test_get_all_restaurants" time="0.005"><failure message="assert 500 == 200&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code">food_api\tests\test_main_api.py:29: in test_get_all_restaurants
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code</failure></testcase><testcase classname="tests.test_main_api.TestPublicEndpoints" name="test_get_restaurants_by_cuisine" time="0.005"><failure message="assert 500 == 200&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code">food_api\tests\test_main_api.py:38: in test_get_restaurants_by_cuisine
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code</failure></testcase><testcase classname="tests.test_main_api.TestPublicEndpoints" name="test_get_restaurant_by_name" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestPublicEndpoints" name="test_get_nonexistent_restaurant" time="0.004"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_main_api.py", line 59, in test_get_nonexistent_restaurant
    |     response = await async_client.get("/restaurants/NonExistentRestaurant")
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;9 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    |     restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_main_api.py", line 59, in test_get_nonexistent_restaurant
    response = await async_client.get("/restaurants/NonExistentRestaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;9 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_main_api.py:59: in test_get_nonexistent_restaurant
    response = await async_client.get("/restaurants/NonExistentRestaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1768: in get
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:307: in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_main_api.TestUserAuthenticationFlow" name="test_register_new_user" time="0.007"><failure message="assert 500 == 200&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code">food_api\tests\test_main_api.py:79: in test_register_new_user
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code</failure></testcase><testcase classname="tests.test_main_api.TestUserAuthenticationFlow" name="test_register_duplicate_username" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestUserAuthenticationFlow" name="test_login_with_valid_credentials" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestUserAuthenticationFlow" name="test_login_with_invalid_password" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestUserAuthenticationFlow" name="test_login_with_nonexistent_user" time="0.007"><failure message="assert 429 == 401&#10; +  where 429 = &lt;Response [429 Too Many Requests]&gt;.status_code">food_api\tests\test_main_api.py:142: in test_login_with_nonexistent_user
    assert response.status_code == 401
E   assert 429 == 401
E    +  where 429 = &lt;Response [429 Too Many Requests]&gt;.status_code</failure></testcase><testcase classname="tests.test_main_api.TestProtectedEndpoints" name="test_create_order_without_auth" time="0.005"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_main_api.py", line 158, in test_create_order_without_auth
    |     response = await async_client.post("/orders/", json=order_data)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1859, in post
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;13 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 1001, in create_order
    |     restaurant = await Restaurant.find_one(Restaurant.name == order_data.restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_main_api.py", line 158, in test_create_order_without_auth
    response = await async_client.post("/orders/", json=order_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1859, in post
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;13 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 1001, in create_order
    restaurant = await Restaurant.find_one(Restaurant.name == order_data.restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_main_api.py:158: in test_create_order_without_auth
    response = await async_client.post("/orders/", json=order_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1859: in post
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:1001: in create_order
    restaurant = await Restaurant.find_one(Restaurant.name == order_data.restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_main_api.TestProtectedEndpoints" name="test_create_order_with_auth" time="0.021"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestProtectedEndpoints" name="test_get_user_orders" time="0.006"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestProtectedEndpoints" name="test_add_review_with_auth" time="0.008"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestProtectedEndpoints" name="test_add_review_without_auth" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestReviewEndpoints" name="test_get_reviews_for_restaurant" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestReviewEndpoints" name="test_get_review_stats" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestItemSearch" name="test_search_items_basic" time="0.005"><failure message="assert 500 in [200, 404]&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code">food_api\tests\test_main_api.py:259: in test_search_items_basic
    assert response.status_code in [200, 404]  # May or may not find results
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 500 in [200, 404]
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code</failure></testcase><testcase classname="tests.test_main_api.TestItemSearch" name="test_search_items_case_insensitive" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestSecurityVulnerabilities" name="test_sql_injection_in_restaurant_search" time="0.004"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_main_api.py", line 291, in test_sql_injection_in_restaurant_search
    |     response = await async_client.get(f"/restaurants/{malicious_input}")
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;9 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    |     restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_main_api.py", line 291, in test_sql_injection_in_restaurant_search
    response = await async_client.get(f"/restaurants/{malicious_input}")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;9 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_main_api.py:291: in test_sql_injection_in_restaurant_search
    response = await async_client.get(f"/restaurants/{malicious_input}")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1768: in get
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:307: in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_main_api.TestSecurityVulnerabilities" name="test_invalid_token_rejected" time="0.009" /><testcase classname="tests.test_main_api.TestSecurityVulnerabilities" name="test_xss_in_review_comment" time="0.008"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_main_api.TestPerformance" name="test_restaurant_list_response_time" time="0.005"><failure message="assert 500 == 200&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code">food_api\tests\test_main_api.py:349: in test_restaurant_list_response_time
    assert response.status_code == 200
E   assert 500 == 200
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code</failure></testcase><testcase classname="tests.test_main_api.TestPerformance" name="test_concurrent_order_creation" time="0.009"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderCreation" name="test_order_001_create_valid_multiitem_order" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderCreation" name="test_order_002_nonexistent_restaurant" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderCreation" name="test_order_003_invalid_quantity_zero" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderCreation" name="test_order_004_excessive_quantity" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderCreation" name="test_order_005_empty_items_array" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderCreation" name="test_order_006_too_many_items" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderCreation" name="test_order_007_negative_price" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderRetrieval" name="test_order_008_get_user_order_history" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderRetrieval" name="test_order_009_get_own_specific_order" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderRetrieval" name="test_order_010_access_another_users_order_idor" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderEdgeCases" name="test_order_without_authentication" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_order_management_comprehensive.TestOrderEdgeCases" name="test_order_total_price_calculation" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_001_root_endpoint" time="0.005" /><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_002_get_all_restaurants" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_003_filter_by_cuisine_gujarati" time="0.004"><failure message="RuntimeError: Event loop is closed">food_api\tests\test_public_endpoints_comprehensive.py:108: in test_pub_003_filter_by_cuisine_gujarati
    await gujarati_restaurant.insert()
..\..\..\Lib\site-packages\beanie\odm\actions.py:237: in wrapper
    result = await f(
..\..\..\Lib\site-packages\beanie\odm\utils\state.py:89: in wrapper
    result = await f(self, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\utils\self_validation.py:19: in wrapper
    return await f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\documents.py:368: in insert
    result = await self.get_pymongo_collection().insert_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_004_filter_by_nonexistent_cuisine" time="0.005"><failure message="assert 500 == 200&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   200 = status.HTTP_200_OK">food_api\tests\test_public_endpoints_comprehensive.py:141: in test_pub_004_filter_by_nonexistent_cuisine
    assert response.status_code == status.HTTP_200_OK
E   assert 500 == 200
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   200 = status.HTTP_200_OK</failure></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_005_get_specific_restaurant" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_006_get_nonexistent_restaurant" time="0.004"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_public_endpoints_comprehensive.py", line 184, in test_pub_006_get_nonexistent_restaurant
    |     response = await async_client.get("/restaurants/NonExistentCafe")
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;9 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    |     restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_public_endpoints_comprehensive.py", line 184, in test_pub_006_get_nonexistent_restaurant
    response = await async_client.get("/restaurants/NonExistentCafe")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;9 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 307, in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_public_endpoints_comprehensive.py:184: in test_pub_006_get_nonexistent_restaurant
    response = await async_client.get("/restaurants/NonExistentCafe")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1768: in get
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:307: in get_restaurant_by_name
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_007_search_existing_item" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_008_search_nonexistent_item" time="0.004"><failure message="assert 500 == 200&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code&#10; +  and   200 = status.HTTP_200_OK">food_api\tests\test_public_endpoints_comprehensive.py:234: in test_pub_008_search_nonexistent_item
    assert response.status_code == status.HTTP_200_OK
E   assert 500 == 200
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code
E    +  and   200 = status.HTTP_200_OK</failure></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_009_search_missing_parameter" time="0.005" /><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_010_get_restaurant_reviews" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_011_get_reviews_nonexistent_restaurant" time="0.004"><failure message="RuntimeError: Event loop is closed">+ Exception Group Traceback (most recent call last):
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 79, in collapse_excgroups
  |     yield
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 183, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ~~~~~~~~~~~~~~~~~~~~~~~^^
  |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\anyio\_backends\_asyncio.py", line 772, in __aexit__
  |     raise BaseExceptionGroup(
  |         "unhandled errors in a TaskGroup", self._exceptions
  |     ) from None
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 344, in from_call
    |     result: TResult | None = func()
    |                              ~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 246, in &lt;lambda&gt;
    |     lambda: runtest_hook(item=item, **kwds), when=when, reraise=reraise
    |             ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\logging.py", line 850, in pytest_runtest_call
    |     yield
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\capture.py", line 900, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\skipping.py", line 263, in pytest_runtest_call
    |     return (yield)
    |             ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\runner.py", line 178, in pytest_runtest_call
    |     item.runtest()
    |     ~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 474, in runtest
    |     super().runtest()
    |     ~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 1671, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 167, in _multicall
    |     raise exception
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |     ~~~~~~~~~~~~~~^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pluggy\_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\_pytest\python.py", line 157, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\pytest_asyncio\plugin.py", line 721, in inner
    |     runner.run(coro, context=context)
    |     ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\runners.py", line 118, in run
    |     return self._loop.run_until_complete(task)
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 725, in run_until_complete
    |     return future.result()
    |            ~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_public_endpoints_comprehensive.py", line 314, in test_pub_011_get_reviews_nonexistent_restaurant
    |     response = await async_client.get("/restaurants/NonExistentCafe/reviews")
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    |     return await self.request(
    |            ^^^^^^^^^^^^^^^^^^^
    |     ...&lt;9 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    |     return await self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    |     response = await self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;4 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    |     response = await self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    |     response = await self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    |     response = await transport.handle_async_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    |     with recv_stream, send_stream, collapse_excgroups():
    |                                    ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    |     self.gen.throw(value)
    |     ~~~~~~~~~~~~~~^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    |     raise app_exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    |     await route.handle(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    |     await self.app(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    |     raise exc
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    |     response = await f(request)
    |                ^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    |     raw_response = await run_endpoint_function(
    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;3 lines&gt;...
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    |     return await dependant.call(**values)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 433, in get_restaurant_reviews
    |     restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
    |                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    |     document = yield from self._find_one().__await__()  # type: ignore
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    |     return await self.document_model.get_pymongo_collection().find_one(
    |                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         filter=self.get_filter_query(),
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     ...&lt;2 lines&gt;...
    |         **self.pymongo_kwargs,
    |         ^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    |     return framework.run_on_executor(
    |            ~~~~~~~~~~~~~~~~~~~~~~~~~^
    |         loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
    |         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |     )
    |     ^
    |   File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    |     return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
    |            ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    |     self._check_closed()
    |     ~~~~~~~~~~~~~~~~~~^^
    |   File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    |     raise RuntimeError('Event loop is closed')
    | RuntimeError: Event loop is closed
    +------------------------------------

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\tests\test_public_endpoints_comprehensive.py", line 314, in test_pub_011_get_reviews_nonexistent_restaurant
    response = await async_client.get("/restaurants/NonExistentCafe/reviews")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1768, in get
    return await self.request(
           ^^^^^^^^^^^^^^^^^^^
    ...&lt;9 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1540, in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1629, in send
    response = await self._send_handling_auth(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;4 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1657, in _send_handling_auth
    response = await self._send_handling_redirects(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1694, in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_client.py", line 1730, in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\httpx\_transports\asgi.py", line 170, in handle_async_request
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\applications.py", line 1133, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 182, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\contextlib.py", line 162, in __exit__
    self.gen.throw(value)
    ~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_utils.py", line 85, in collapse_excgroups
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 184, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 244, in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 159, in call_next
    raise app_exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 123, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 109, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 387, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;3 lines&gt;...
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\fastapi\routing.py", line 288, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\API\agent workspace\food_api_agent-1\food_api\app\main.py", line 433, in get_restaurant_reviews
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 1030, in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\beanie\odm\queries\find.py", line 997, in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        filter=self.get_filter_query(),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...&lt;2 lines&gt;...
        **self.pymongo_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\metaprogramming.py", line 75, in method
    return framework.run_on_executor(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        loop, sync_method, self.delegate, *unwrapped_args, **unwrapped_kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Skill\Desktop\m\Lib\site-packages\motor\frameworks\asyncio\__init__.py", line 85, in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 888, in run_in_executor
    self._check_closed()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Skill\Desktop\m\Lib\asyncio\base_events.py", line 556, in _check_closed
    raise RuntimeError('Event loop is closed')
RuntimeError: Event loop is closed

During handling of the above exception, another exception occurred:
food_api\tests\test_public_endpoints_comprehensive.py:314: in test_pub_011_get_reviews_nonexistent_restaurant
    response = await async_client.get("/restaurants/NonExistentCafe/reviews")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1768: in get
    return await self.request(
..\..\..\Lib\site-packages\httpx\_client.py:1540: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1629: in send
    response = await self._send_handling_auth(
..\..\..\Lib\site-packages\httpx\_client.py:1657: in _send_handling_auth
    response = await self._send_handling_redirects(
..\..\..\Lib\site-packages\httpx\_client.py:1694: in _send_handling_redirects
    response = await self._send_single_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_client.py:1730: in _send_single_request
    response = await transport.handle_async_request(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\httpx\_transports\asgi.py:170: in handle_async_request
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\applications.py:1133: in __call__
    await super().__call__(scope, receive, send)
..\..\..\Lib\site-packages\starlette\applications.py:113: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\errors.py:186: in __call__
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\errors.py:164: in __call__
    await self.app(scope, receive, _send)
..\..\..\Lib\site-packages\starlette\middleware\base.py:182: in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\contextlib.py:162: in __exit__
    self.gen.throw(value)
..\..\..\Lib\site-packages\starlette\_utils.py:85: in collapse_excgroups
    raise exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:184: in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:244: in add_request_id_middleware
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\starlette\middleware\base.py:159: in call_next
    raise app_exc
..\..\..\Lib\site-packages\starlette\middleware\base.py:144: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
..\..\..\Lib\site-packages\starlette\middleware\cors.py:85: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\middleware\exceptions.py:63: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\middleware\asyncexitstack.py:18: in __call__
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:716: in __call__
    await self.middleware_stack(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:736: in app
    await route.handle(scope, receive, send)
..\..\..\Lib\site-packages\starlette\routing.py:290: in handle
    await self.app(scope, receive, send)
..\..\..\Lib\site-packages\fastapi\routing.py:123: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
..\..\..\Lib\site-packages\starlette\_exception_handler.py:53: in wrapped_app
    raise exc
..\..\..\Lib\site-packages\starlette\_exception_handler.py:42: in wrapped_app
    await app(scope, receive, sender)
..\..\..\Lib\site-packages\fastapi\routing.py:109: in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\fastapi\routing.py:387: in app
    raw_response = await run_endpoint_function(
..\..\..\Lib\site-packages\fastapi\routing.py:288: in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\app\main.py:433: in get_restaurant_reviews
    restaurant = await Restaurant.find_one(Restaurant.name == restaurant_name)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</failure></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_012_review_pagination_limit" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_013_review_pagination_skip" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_014_review_statistics" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpoints" name="test_pub_015_health_check" time="0.004"><failure message="AssertionError: assert 'connected' in 'error: event loop is closed'&#10; +  where 'error: event loop is closed' = &lt;built-in method lower of str object at 0x00000277E399E100&gt;()&#10; +    where &lt;built-in method lower of str object at 0x00000277E399E100&gt; = 'error: Event loop is closed'.lower&#10; +      where 'error: Event loop is closed' = str('error: Event loop is closed')">food_api\tests\test_public_endpoints_comprehensive.py:476: in test_pub_015_health_check
    assert "connected" in str(data["database"]).lower()
E   AssertionError: assert 'connected' in 'error: event loop is closed'
E    +  where 'error: event loop is closed' = &lt;built-in method lower of str object at 0x00000277E399E100&gt;()
E    +    where &lt;built-in method lower of str object at 0x00000277E399E100&gt; = 'error: Event loop is closed'.lower
E    +      where 'error: Event loop is closed' = str('error: Event loop is closed')</failure></testcase><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpointsSmokeTests" name="test_api_is_running" time="0.004" /><testcase classname="tests.test_public_endpoints_comprehensive.TestPublicEndpointsSmokeTests" name="test_critical_endpoints_accessible" time="0.006"><failure message="AssertionError: Endpoint /restaurants/ should be accessible&#10;assert 500 in [200, 404]&#10; +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code">food_api\tests\test_public_endpoints_comprehensive.py:500: in test_critical_endpoints_accessible
    assert response.status_code in [
E   AssertionError: Endpoint /restaurants/ should be accessible
E   assert 500 in [200, 404]
E    +  where 500 = &lt;Response [500 Internal Server Error]&gt;.status_code</failure></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewCreation" name="test_rev_001_create_valid_review" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewCreation" name="test_rev_002_rating_out_of_range" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewCreation" name="test_rev_003_comment_too_short" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewCreation" name="test_rev_004_duplicate_review" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewCreation" name="test_rev_005_restaurant_name_mismatch" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewCreation" name="test_rev_006_xss_protection" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewUpdateDelete" name="test_rev_007_update_own_review" time="0.004"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewUpdateDelete" name="test_rev_008_update_another_users_review_idor" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewUpdateDelete" name="test_rev_009_delete_own_review" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewUpdateDelete" name="test_rev_010_delete_another_users_review_idor" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:244: in test_restaurant
    existing = await Restaurant.find_one(Restaurant.name == "Test Restaurant")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_review_system_comprehensive.TestReviewRetrieval" name="test_rev_011_get_my_reviews" time="0.003"><error message="failed on setup with &quot;RuntimeError: Event loop is closed&quot;">..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:463: in setup
    return super().setup()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:748: in pytest_fixture_setup
    hook_result = yield
                  ^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:318: in _asyncgen_fixture_wrapper
    result = runner.run(setup(), context=context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\runners.py:118: in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:725: in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\pytest_asyncio\plugin.py:314: in setup
    res = await gen_obj.__anext__()
          ^^^^^^^^^^^^^^^^^^^^^^^^^
food_api\tests\conftest.py:56: in test_user
    existing_user = await User.find_one(User.username == "testuser")
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:1030: in __await__
    document = yield from self._find_one().__await__()  # type: ignore
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\site-packages\beanie\odm\queries\find.py:997: in _find_one
    return await self.document_model.get_pymongo_collection().find_one(
..\..\..\Lib\site-packages\motor\metaprogramming.py:75: in method
    return framework.run_on_executor(
..\..\..\Lib\site-packages\motor\frameworks\asyncio\__init__.py:85: in run_on_executor
    return loop.run_in_executor(_EXECUTOR, functools.partial(fn, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
..\..\..\Lib\asyncio\base_events.py:888: in run_in_executor
    self._check_closed()
..\..\..\Lib\asyncio\base_events.py:556: in _check_closed
    raise RuntimeError('Event loop is closed')
E   RuntimeError: Event loop is closed</error></testcase><testcase classname="tests.test_security.TestPasswordHashing" name="test_password_hashing_creates_different_hash" time="0.347" /><testcase classname="tests.test_security.TestPasswordHashing" name="test_same_password_creates_different_hashes" time="0.618" /><testcase classname="tests.test_security.TestPasswordHashing" name="test_verify_password_with_correct_password" time="0.772" /><testcase classname="tests.test_security.TestPasswordHashing" name="test_verify_password_with_incorrect_password" time="0.680" /><testcase classname="tests.test_security.TestPasswordHashing" name="test_empty_password_handling" time="1.170" /><testcase classname="tests.test_security.TestPasswordHashing" name="test_long_password_truncation" time="1.264" /><testcase classname="tests.test_security.TestPasswordHashing" name="test_unicode_password_support" time="1.642" /><testcase classname="tests.test_security.TestJWTTokens" name="test_create_access_token_basic" time="0.001" /><testcase classname="tests.test_security.TestJWTTokens" name="test_token_contains_correct_data" time="0.001" /><testcase classname="tests.test_security.TestJWTTokens" name="test_token_with_custom_expiration" time="0.002" /><testcase classname="tests.test_security.TestJWTTokens" name="test_token_with_additional_claims" time="0.001" /><testcase classname="tests.test_security.TestJWTTokens" name="test_token_signature_validation" time="0.002" /><testcase classname="tests.test_security.TestSecurityConstants" name="test_secret_key_exists" time="0.001" /><testcase classname="tests.test_security.TestSecurityConstants" name="test_algorithm_is_correct" time="0.001" /><testcase classname="tests.test_security.TestSecurityVulnerabilities" name="test_timing_attack_resistance" time="1.600" /><testcase classname="tests.test_security.TestSecurityVulnerabilities" name="test_password_hash_not_reversible" time="0.385" /><testcase classname="tests.test_security.TestSecurityVulnerabilities" name="test_weak_password_detection" time="3.732" /></testsuite></testsuites>